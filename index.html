<!DOCTYPE html>
<html>
<head>
    <title>jeuStations</title>
</head>
<body>

<canvas id="carte_ratp" width="810" height="808">
    L'objet Canvas ne marche pas chez vous, veuillez utiliser un navigateur r√©cent.
</canvas>

<script>
    var canvas = document.getElementById('carte_ratp');
    var context = canvas.getContext('2d');
    var imageObj = new Image();

    imageObj.onload = function() {
        context.drawImage(imageObj, 0, 0);
    };
    imageObj.src = "content/carte.jpg";

    window.onload = function()
    {
        var xhr = getXMLHttpRequest();
        xhr.open("GET", "ChargementStations.php" , true);
        xhr.send(null);
        xhr.onreadystatechange = function() {
            if (xhr.readyState == 4 && (xhr.status == 200 || xhr.status == 0)) {
                var stations = JSON.parse(xhr.responseText);
                console.log(stations[0]);
                var item = stations[0];
                drawCircle(canvas, item.x/10, item.y/10);
            }
        };
    }

    /*
     Charge l'objet HttpRequest
     */

    function getXMLHttpRequest() {
        var xhr = null;
        if (window.XMLHttpRequest || window.ActiveXObject) {
            if (window.ActiveXObject) {
                try {
                    xhr = new ActiveXObject("Msxml2.XMLHTTP");
                } catch(e) {
                    xhr = new ActiveXObject("Microsoft.XMLHTTP");
                }
            } else {
                xhr = new XMLHttpRequest();
            }
        } else {
            alert("Votre navigateur ne supporte pas l'objet XMLHTTPRequest...");
            return null;
        }

        return xhr;
    }

    /**
     * Draw a circle at a specific location within the canvas
     * @param x
     * @param y
     */
    function drawCircle(canvas, x, y){
        var radius = 8;

        context.beginPath();
        context.arc(x, y, radius, 0, 2 * Math.PI, false);
        context.fillStyle = 'red';
        context.fill();
        context.stroke();
    }

</script>
</body>
</html>